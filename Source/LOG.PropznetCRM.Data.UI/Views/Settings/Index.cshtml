@using LOG.PropznetCRM.Data.Infrastructure;
@{
    ViewBag.Title = "Settings";
}
<link href="~/jquery-upload-file-master/css/uploadfile.min.css" rel="stylesheet" />

<div class="bdr">
    <ul class="nav nav-tabs">
        <li class="active"><a href="#logo-tab" data-toggle="tab">Change Logo <i class="fa"></i></a></li>
        <li><a href="#paging-tab" data-toggle="tab">Paging Size <i class="fa"></i></a></li>
    </ul>
    <form id="accountForm" method="post" class="form-horizontal">
        <div class="tab-content">
            <div class="tab-pane active" id="logo-tab">
                <div class="col-xs-6">
                    <div class="form-group">

                    </div>
                    </div>
                    <div class="col-xs-6">
                        <div class="form-group">
                            <input type="file" id="filelogo" name="filelogo" />
                        </div>
                    </div>
                </div>

            <div class="tab-pane" id="paging-tab">
                <div class="col-xs-6">
                    <div class="form-group">
                        <label class="col-xs-3 control-label">Paging Size</label>
                        <div class="col-xs-5">
                            <input type="text" class="form-control" name="pagingsize" data-bind="value:pagingSize" />
                        </div>
                    </div>
                    <div class="form-group" style="margin-top: 15px;">
                        <div class="col-xs-5 col-xs-offset-3">
                            <button type="button" class="btn btn-default" data-bind="click:Change">Change</button>
                        </div>
                    </div>
                    </div>
                </div>
        </div>
    </form>
</div>

@section scripts{
<script type="text/javascript" >
    $(document).ready(function () {       
              $("#filelogo").fileinput({
                showCaption: false,
                initialPreview: ["<img src='@StringTrimmer.QuotesRemover(ImageUrlResolver.ThumbNail(),ViewBag.Settings.LogoPath)' class='file-preview-image' style='width:100%;height:100%' alt='Desert' title='Desert'>"],
                showUpload: true,
                showRemove: false,
                allowedFileTypes: ["image"],
                allowedPreviewTypes: ["image"],
                allowedFileExtensions: ["jpg", "jpeg", "png"],
                uploadLabel: "Change Logo",
                uploadUrl: "/Api/SettingsApi/ChangeLogo",
                uploadAsync: true
                });

            $('#filelogo').on('fileuploaded', function (event, data, previewId, index) {
            if(data.response!=null)
            {
                bootbox.alert(data.response, function() {
                    window.location.href = '/Settings/Index';
                });
                
            }
            else
            {
                bootbox.alert("Successfully updated logo");
            }
        });
    });
</script>
    }
